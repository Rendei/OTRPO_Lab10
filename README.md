# Мониторинг системы с использованием Prometheus и Grafana

Этот проект создает систему мониторинга с помощью **Prometheus** для сбора метрик и **Grafana** для визуализации данных. В проекте используется **Exporter** для сбора системных метрик (процессоры, память, диск) и их отправки в Prometheus, который затем передает данные в Grafana для отображения в виде графиков.

## Содержание

- [Технологии](#технологии)
- [Запуск проекта](#запуск-проекта)
  - [Запуск в Docker](#запуск-в-docker)
- [Exporter](#exporter)
- [Настройка Grafana](#настройка-grafana)
- [PromQL запросы](#promql-запросы)
- [Подключение источников данных](#подключение-источников-данных)

## Технологии

- **Prometheus** - система мониторинга и сбора метрик.
- **Grafana** - инструмент для визуализации данных.
- **Docker** - для контейнеризации всех сервисов.
- **Python** - для написания экспортера метрик.

## Запуск проекта

### Запуск в Docker

1. Склонируйте репозиторий на свой компьютер:
   
   ```bash
   git clone https://github.com/Rendei/OTRPO_Lab10
   cd OTRPO_Lab10
   ```

2. Запустите проект с помощью Docker Compose:

   ```bash
   docker-compose up --build -d
   ```

   Это запустит контейнеры с Prometheus, Grafana и экспортером.

3. После того как контейнеры будут запущены, доступ к сервисам будет:

   - **Prometheus**: [http://localhost:9090](http://localhost:9090)
   - **Grafana**: [http://localhost:3000](http://localhost:3000) (Логин: `admin`, Пароль: `admin`)

## Exporter

Exporter собирает следующие метрики с системы:

- Использование процессоров
- Общий объем оперативной памяти и ее использование
- Общий объем и использование дисков

Exporter запускается на порту **8080** и предоставляет метрики на корневом пути `/`.

### Настройка экспортера

Экспортер работает с переменными окружения:

- **EXPORTER_HOST** - хост, на котором экспортер будет слушать запросы (по умолчанию `0.0.0.0`).
- **EXPORTER_PORT** - порт, на котором экспортер будет слушать запросы (по умолчанию `8080`).

Их можно настроить в файле `docker-compose.yml`.

## Настройка Grafana

1. Откройте Grafana по адресу [http://localhost:3000](http://localhost:3000).
2. Введите логин и пароль (по умолчанию `admin` / `admin`).
3. Подключите Prometheus как источник данных:
   - Перейдите в **Connection > Data Sources**.
   - Выберите **Prometheus** и укажи URL `http://prometheus:9090`.
   - Нажмите **Save & Test**.

4. Создайте дэшборд:
   - Перейди в **+ > Dashboard**.
   - Добавьте панель и настрой запросы PromQL для отображения метрик.
   

## PromQL запросы

Примеры запросов PromQL для использования в Grafana:

- **Использование процессора**:
  ```promQL
  cpu_usage_percent
  ```
  
- **Использование памяти**:
  ```promQL
  memory_used
  ```

- **Общий объем памяти**:
  ```promQL
  memory_total
  ```

- **Использование диска**:
  ```promQL
  disk_used
  ```